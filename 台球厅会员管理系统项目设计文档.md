# 台球厅会员管理系统 - 项目设计文档（完整版）
## 文档信息
- **文档版本**：v1.2
- **创建日期**：2025年10月
- **文档类型**：项目设计文档（含技术实现）
- **目标读者**：台球厅经营者、技术开发团队、运营管理人员


## 一、项目概述
### 1.1 项目目标
构建一套轻量化台球厅会员管理系统，支持会员信息管理、充值、消费扣款核心功能，主页展示近7日运营数据，最终打包为Windows可执行文件（.exe），满足中小型台球厅本地化运营需求。

### 1.2 核心价值
- 极简操作：仅保留会员管理、充值、扣款核心功能，降低员工学习成本；
- 本地运行：无需网络依赖，数据存储在本地，确保断网环境下正常使用；
- 数据可视化：主页直观展示近7日充值/消费数据，辅助运营决策。


## 二、功能模块设计
### 2.1 主页数据展示模块
#### 2.1.1 核心数据概览
采用卡片式布局，聚焦近7日关键指标：
- **近7日充值总额**：数字+折线图展示，标注每日充值金额（如10月21日：500元），悬停可查看单日明细；
- **近7日消费总额**：同上，与充值数据并列排版，支持对比分析；
- **数据周期切换**：顶部提供“今日”“近7日”“近30日”筛选选项，默认展示近7日数据。

#### 2.1.2 交互设计
- 点击充值/消费总额卡片，下钻展示对应周期内的明细记录（按时间倒序排列，包含会员信息、金额、操作时间）；
- 实时刷新：完成充值/扣款操作后，主页数据自动更新，无需手动刷新。


### 2.2 会员管理模块
#### 2.2.1 会员列表展示
- **列表字段**：会员编号、姓名、手机号（中间4位脱敏为*）、余额、注册时间；
- **搜索功能**：支持通过“姓名”“手机号”“会员编号”模糊查询；
- **排序与分页**：支持按“余额”“注册时间”升序/降序排序，超过20条自动分页（每页20条）。

#### 2.2.2 会员信息管理
- **核心信息字段**：
  - 姓名（必填，支持中英文）；
  - 手机号（必填，11位数字验证，脱敏展示）；
  - 余额（系统自动计算，不可手动修改）。
- **操作功能**：
  - 新增会员：填写姓名、手机号后提交，自动生成会员编号，初始余额为0；
  - 查看详情：展示会员完整信息（含充值/消费记录）；
  - 编辑信息：支持修改姓名、手机号（余额不可编辑）；
  - 删除会员：仅允许删除余额为0的会员，删除后保留历史记录用于统计。


### 2.3 充值功能模块
#### 2.3.1 核心流程
1. 选择会员：从列表或搜索框定位会员，展示姓名、手机号、当前余额；
2. 输入金额：运营者手动输入充值金额（支持正数，如200、500）；
3. 确认充值：系统校验金额合法性（非负、非零），通过后更新会员余额，生成充值记录（含会员编号、金额、操作人、时间）。


### 2.4 消费功能模块
#### 2.4.1 核心流程
1. 选择会员：同充值流程，定位会员后展示当前余额；
2. 输入金额：运营者手动输入消费金额（支持正数，如50、120）；
3. 余额校验：系统自动判断“当前余额≥消费金额”，不足时提示“余额不足（当前XX元）”；
4. 身份验证：会员输入预设密码（初始密码为手机号后6位，支持修改）；
5. 确认扣款：验证通过后，扣除对应金额并更新余额，生成消费记录（含会员编号、金额、操作人、时间）。


## 三、技术实现方案
### 3.1 技术栈选型
| 技术层面       | 选型方案                  | 选型理由                                                                 |
|----------------|---------------------------|--------------------------------------------------------------------------|
| **前端界面**   | Electron + Vue3 +     | 1. Electron支持打包为Windows可执行文件，适配桌面端环境；<br>2. Vue3语法简洁，开发效率高，适合快速构建交互界面；<br>3. Vant组件库轻量，可快速实现列表、表单等核心页面。 |
| **后端逻辑**   | Node.js（Electron主进程） | 1. 与Electron无缝集成，无需额外部署服务器，前后端同构开发；<br>2. 通过`ipcMain`/`ipcRenderer`实现进程通信，安全处理数据操作；<br>3. 处理会员CRUD、充值/扣款等轻量业务足够高效。 |
| **数据库**     | SQLite + better-sqlite3   | 1. 文件型数据库，无需独立服务，直接嵌入应用，适合本地运行；<br>2. `better-sqlite3`提供高性能同步操作，避免异步回调复杂度；<br>3. 数据存储在本地文件（如`member.db`），备份迁移简单（复制文件即可）。 |
| **打包工具**   | Electron-builder          | 1. 一键打包为Windows可执行文件（.exe）及安装包（.msi）；<br>2. 支持自定义图标、安装路径、权限等Windows应用特性；<br>3. 自动处理依赖打包，适配Windows 7/10/11系统。 |


### 3.2 项目结构设计
```
项目根目录/
├─ src/
│  ├─ renderer/                # 前端渲染进程（Vue3）
│  │  ├─ pages/                # 页面组件
│  │  │  ├─ Home.vue           # 主页（数据展示）
│  │  │  ├─ MemberList.vue     # 会员列表
│  │  │  ├─ Recharge.vue       # 充值页面
│  │  │  └─ Consume.vue        # 消费页面
│  │  └─ main.js               # 前端入口（挂载Vue实例）
│  └─ main/                    # Electron主进程（后端逻辑）
│     ├─ db/                   # 数据库操作
│     │  ├─ init.js            # 数据库初始化（创建表）
│     │  ├─ member.js          # 会员信息CRUD
│     │  └─ record.js          # 充值/消费记录操作
│     ├─ ipc/                  # 进程通信
│     │  ├─ recharge.js        # 充值相关通信
│     │  └─ consume.js         # 消费相关通信
│     └─ main.js               # 主进程入口（创建窗口、注册通信）
├─ package.json                # 项目配置（含打包参数）
└─ dist/                       # 打包输出目录（.exe文件）
```


### 3.3 数据库设计
#### 3.3.1 核心数据表
| 表名           | 字段名               | 类型         | 说明                     |
|----------------|----------------------|--------------|--------------------------|
| `members`      | member_id            | INTEGER      | 会员编号（主键，自增）   |
|                | name                 | TEXT         | 姓名                     |
|                | phone                | TEXT         | 手机号（唯一）           |
|                | balance              | REAL         | 余额（默认0）            |
|                | password             | TEXT         | 密码（初始为手机号后6位）|
|                | create_time          | DATETIME     | 注册时间                 |
| `recharge_log` | recharge_id          | INTEGER      | 充值记录ID（主键，自增） |
|                | member_id            | INTEGER      | 关联会员编号             |
|                | amount               | REAL         | 充值金额                 |
|                | operator             | TEXT         | 操作人                   |
|                | create_time          | DATETIME     | 操作时间                 |
| `consume_log`  | consume_id           | INTEGER      | 消费记录ID（主键，自增） |
|                | member_id            | INTEGER      | 关联会员编号             |
|                | amount               | REAL         | 消费金额                 |
|                | operator             | TEXT         | 操作人                   |
|                | create_time          | DATETIME     | 操作时间                 |


### 3.4 打包配置
在`package.json`中配置`electron-builder`参数，支持Windows打包：
```json
"build": {
  "appId": "com.billiard.member",
  "productName": "台球厅会员管理系统",
  "copyright": "© 2025 台球厅管理系统",
  "win": {
    "target": ["nsis", "exe"],  // 生成安装包和单文件exe
    "icon": "build/icon.ico",   // 应用图标（.ico格式）
    "artifactName": "${productName}-v${version}-${platform}.${ext}"
  },
  "nsis": {
    "oneClick": false,          // 允许自定义安装路径
    "allowToChangeInstallationDirectory": true,
    "installerIcon": "build/icon.ico",
    "uninstallerIcon": "build/icon.ico"
  }
}
```
执行`npm run build`即可在`dist/`目录生成Windows可执行文件及安装包。


## 四、项目实施计划
| 阶段         | 时间节点   | 核心任务                          |
|--------------|------------|-----------------------------------|
| 需求确认     | 第1周      | 确认功能细节、界面原型评审        |
| 开发阶段     | 第2-3周    | 前端页面开发、后端逻辑实现、数据库集成 |
| 测试阶段     | 第4周      | 功能测试（充值/扣款流程、数据准确性）、兼容性测试（Windows系统） |
| 打包部署     | 第4周末    | 配置打包参数、生成.exe文件、测试安装流程 |
| 交付培训     | 第5周      | 交付系统、培训操作人员使用        |


## 五、风险与应对
| 风险点               | 应对措施                                  |
|----------------------|-------------------------------------------|
| 数据丢失             | 每日自动备份数据库文件至本地指定路径（如`C:\备份\`） |
| 操作失误（误充值/扣款） | 记录所有操作日志，支持管理员手动调整余额（需双人确认） |
| 系统兼容性问题       | 测试Windows 7/10/11主流版本，确保正常运行 |

该方案聚焦轻量化与易用性，技术栈统一且成熟，适合快速开发并打包为Windows应用，满足台球厅本地化会员管理需求。